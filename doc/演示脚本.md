# RBAC 系统命令行演示脚本（增强版）

这份脚本旨在帮助你录制一段流畅、专业的系统演示视频。演示流程涵盖了系统的**所有核心功能**，建议时长 **7-10 分钟**。

## 🎬 演示准备

1.  **环境重置**：运行 `java -cp "out;lib/*" com.rbac.util.DatabaseResetUtil` 确保数据库处于干净状态
2.  **编译代码**：`mvn clean compile`
3.  **启动命令**：`mvn exec:java -Dexec.mainClass="com.rbac.MainApp"`

---

## 🎥 演示流程 (8幕 / 7-10分钟)

### 🎬 第一幕：系统介绍与登录认证 (1分钟)

**操作**：
1.  启动系统（注意：未登录时菜单只显示"1. 登录"和"0. 退出系统"）
2.  选择 `1. 登录`
3.  输入 `admin` / `admin123`
4.  登录成功后，菜单变为已登录状态（显示：登出、用户管理、角色管理、权限管理、智能审计分析）
5.  选择 `4. 权限管理` -> `7. 查看我的权限`

**解说词**：
> "这是一个基于 Java 开发的 RBAC 权限管理系统。注意看，未登录时菜单非常简洁，只显示登录选项。我们使用管理员账号登录后，菜单会自动展开，显示所有管理功能。查看权限可以看到，管理员拥有所有系统权限，并且现在以表格形式同时显示权限编码和描述，更加直观。"

---

### 🎬 第二幕：用户生命周期与密码安全 (1.5分钟)

**操作**：
1.  选择 `2. 用户管理` -> `1. 创建用户`
2.  **演示密码复杂度**：
    *   输入 `guest_user` / `123`
    *   系统提示：❌ "密码长度至少为8位"
    *   询问 "是否重试？(y/n)"，输入 `y` 重试
    *   输入 `guest_user` / `12345678`
    *   系统提示：❌ "密码必须包含字母和数字"
    *   输入 `y` 再次重试
    *   输入 `guest_user` / `Guest123456`
    *   ✅ 创建成功
3.  选择 `5. 查看所有用户`，展示用户列表

**解说词**：
> "创建用户时，系统会进行严格的密码复杂度验证。刚才我们看到，密码长度不足8位会被拒绝，纯数字密码也会被拒绝。这保证了系统的账户安全。另外，当输入错误时，系统会询问是否重试，提升了用户体验。"

---

### 🎬 第三幕：RBAC 权限控制 - 无权状态 (1分钟)

**操作**：
1.  选择 `0. 返回主菜单` -> `1. 登出`（注意：已登录时"登出"是编号1）
2.  菜单恢复为未登录状态（只显示"1. 登录"和"0. 退出系统"）
3.  登录 `guest_user` / `Guest123456`
4.  选择 `4. 权限管理` -> `7. 查看我的权限`
    *   显示：暂无权限（表格格式）
5.  选择 `2. 用户管理` -> `1. 创建用户`
    *   **关键点：立即拦截！**
    *   系统提示：❌ "权限不足：需要权限 [USER:CREATE]"
    *   **不会要求输入用户名和密码**

**解说词**：
> "现在我们切换到刚创建的 guest_user。注意菜单又变回了登录后的完整菜单。查看权限发现他没有任何权限。当我们尝试创建用户时，系统会立即检查权限并拦截，而不是等用户输入完所有信息后才提示。这是新优化的功能，大大提升了用户体验。"

---

### 🎬 第四幕：动态授权与权限生效 (1.5分钟)

**操作**：
1.  登出，切回 `admin`
2.  选择 `3. 角色管理` -> `4. 为用户分配角色`
    *   选择 `guest_user` 的 ID
    *   选择 `GUEST` 角色 (ID=4)
3.  选择 `3. 角色管理` -> `6. 查看用户的角色`
    *   输入 `guest_user` 的 ID
    *   显示：GUEST 角色
4.  选择 `4. 权限管理` -> `6. 查看角色的权限`
    *   输入 GUEST 角色 ID
    *   显示：USER:LIST (只有查看权限，表格格式显示编码和描述)
5.  登出，切回 `guest_user`
6.  选择 `4. 权限管理` -> `7. 查看我的权限`
    *   现在显示：USER:LIST（表格格式，包含描述"查看用户列表"）
7.  选择 `2. 用户管理` -> `5. 查看所有用户`
    *   ✅ 成功！
8.  选择 `2. 用户管理` -> `1. 创建用户`
    *   ❌ 仍然失败！权限不足

**解说词**：
> "管理员为 guest_user 分配了 GUEST 角色。我们切回该用户，发现他现在拥有了 USER:LIST 权限，并且权限显示更加友好，同时展示了权限编码和描述。尝试查看用户列表，成功！但尝试创建用户，仍然失败。这展示了 RBAC 精细化权限控制的能力，权限变更无需重启系统，实时生效。"

---

### 🎬 第五幕：角色与权限管理 + 操作取消演示 (2分钟)

**操作**：
1.  切回 `admin`
2.  选择 `4. 权限管理` -> `1. 创建权限`
    *   **演示取消功能**：输入权限编码时输入 `0`
    *   系统显示：✓ 操作已取消
    *   返回权限管理菜单
3.  再次选择 `1. 创建权限`
    *   输入 `REPORT:GENERATE` / `生成报表`
    *   ✅ 创建成功
4.  选择 `3. 角色管理` -> `1. 创建角色`
    *   输入 `REPORTER` / `报表员` / `负责生成各类报表`
5.  选择 `4. 权限管理` -> `4. 为角色分配权限`
    *   选择 REPORTER 角色
    *   选择 REPORT:GENERATE 权限
6.  选择 `4. 权限管理` -> `6. 查看角色的权限`
    *   输入 REPORTER 角色 ID
    *   显示：REPORT:GENERATE（表格格式）

**解说词**：
> "系统支持自定义权限和角色。注意刚才我们演示了新增的操作取消功能，在任何输入环节都可以输入 0 或 q 来取消操作并返回上级菜单，这大大提升了操作的灵活性。我们创建了一个 'REPORT:GENERATE' 权限，又创建了一个 'REPORTER' 角色，并将权限分配给角色。这种灵活的权限模型可以适应各种业务场景。"

---

### 🎬 第六幕：用户冻结与安全管理 (1分钟)

**操作**：
1.  选择 `2. 用户管理` -> `3. 冻结用户`
    *   输入 `guest_user` 的 ID
    *   ✅ 冻结成功
2.  选择 `5. 查看所有用户`
    *   显示：guest_user 状态为 "冻结"
3.  登出，尝试用 `guest_user` / `Guest123456` 登录
    *   ❌ 失败！提示："账户已被冻结，请联系管理员"
4.  切回 `admin`，选择 `2. 用户管理` -> `4. 解冻用户`
    *   输入 `guest_user` 的 ID
    *   ✅ 解冻成功
5.  登出，`guest_user` 重新登录
    *   ✅ 成功！

**解说词**：
> "系统提供了用户冻结功能。管理员可以快速冻结可疑账号，被冻结的用户无法登录。解冻后，账号立即恢复正常。这为系统安全管理提供了有力保障。"

---

### 🎬 第七幕：智能审计与安全防护 (1.5分钟)

**操作**：
1.  登出（菜单恢复为未登录状态）
2.  **模拟暴力破解**：
    *   选择 `1. 登录`
    *   输入 `admin` / `wrongpass`
    *   ❌ 失败！询问 "是否重试？(y/n)"
    *   输入 `y`
    *   再次输错密码 (重复 3-4 次)
    *   最后输入 `n` 不再重试
3.  用正确密码 `admin` / `admin123` 登录
4.  选择 `5. 智能审计分析`
    *   系统分析 `logs/audit.log`
    *   显示：⚠ **高风险：用户[admin]在[xxx]这一小时内登录失败X次，可能存在暴力破解或异常登录**

**解说词**：
> "系统内置了智能审计分析模块。刚才我们模拟了暴力破解攻击，多次输入错误密码。现在执行审计分析，系统通过流式处理日志文件，精准识别出了异常行为并给出高风险告警。这种智能分析能力帮助管理员及时发现安全威胁。"

---

### 🎬 第八幕：总结与退出 (30秒)

**操作**：
1.  选择 `1. 登出`
2.  菜单变回未登录状态
3.  选择 `0. 退出系统`

**解说词**：
> "以上就是 RBAC 权限管理系统的完整演示。我们展示了状态感知的智能菜单、用户生命周期、密码安全、RBAC 权限控制、动态授权、灵活的操作取消、角色权限管理、用户冻结以及智能审计分析等功能。系统具备完善的权限模型、优秀的用户体验和强大的安全防护能力。感谢观看！"

---

## 💡 录制小贴士

###  终端设置
*   **字体放大**：设置 -> 外观 -> 字体大小 18-20 (便于观看)
*   **颜色方案**：选择高对比度方案 (如 Solarized Dark)
*   **窗口大小**：调整为 16:9 或 4:3，不要全屏

### 📹 录制技巧
*   **鼠标高亮**：用鼠标选中关键信息 ("权限不足"、"高风险" 等)
*   **适当停顿**：每完成一个操作后停顿 1-2 秒，让观众看清结果
*   **清屏**：如果屏幕太乱，可以重启应用保持整洁
*   **口齿清晰**：按照解说词自然阅读，不要太快

### ⚠️ 常见问题
*   **密码记不住**：Guest123456 (注意大小写)
*   **ID 找不到**：查看列表时记下 ID，或者在纸上写下来
*   **重试功能**：如果不小心输错，利用 "是否重试？(y/n)" 功能重新输入
*   **取消功能**：任何输入环节都可以输入 `0` 或 `q` 返回上级菜单

### ⏱️ 时间分配参考
| 章节 | 时长 | 累计 |
|------|------|------|
| 第一幕 | 1:00 | 1:00 |
| 第二幕 | 1:30 | 2:30 |
| 第三幕 | 1:00 | 3:30 |
| 第四幕 | 1:30 | 5:00 |
| 第五幕 | 2:00 | 7:00 |
| 第六幕 | 1:00 | 8:00 |
| 第七幕 | 1:30 | 9:30 |
| 第八幕 | 0:30 | 10:00 |

---

## ✅ 演示前检查清单

- [ ] 数据库已启动且可连接
- [ ] 已运行数据库重置脚本 `DatabaseResetUtil`
- [ ] 已执行 `mvn clean compile` 且无错误
- [ ] 终端字体和颜色设置完成
- [ ] 录制软件已准备就绪
- [ ] 麦克风音量调试完成
- [ ] 已通读一遍演示脚本，熟悉流程

祝你录制顺利！🎉
